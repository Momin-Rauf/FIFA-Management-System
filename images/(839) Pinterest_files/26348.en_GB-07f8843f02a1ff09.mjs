(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[26348],{418601:(e,t,a)=>{var i=a(14841),s=1/0;e.exports=function(e){return e?(e=i(e))===s||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},640554:(e,t,a)=>{var i=a(418601);e.exports=function(e){var t=i(e),a=t%1;return t==t?a?t-a:t:0}},81226:(e,t,a)=>{function i(e){const t=Math.round(e/1e3),a=t%60;return Math.floor(t/60)+":"+(a<10?"0":"")+a}a.d(t,{Z:()=>i})},694379:(e,t,a)=>{a.d(t,{Z:()=>o});var i=a(892819),s=a(780280),n=a(785893);const o=({currency:e,maximumFractionDigits:t,minimumFractionDigits:a,shortform:o,shortformMaximumFractionDigits:r,formatStyle:l,uplimit:d,value:h})=>{const c=(0,i.Z)();return(0,n.jsx)(s.LC,{children:i=>c(i.locale||"en-US",h,{currency:e,maximum_fraction_digits:t,minimum_fraction_digits:a,shortform:o,shortform_maximum_fraction_digits:r,style:l,uplimit:d})})}},892819:(e,t,a)=>{a.d(t,{Z:()=>r});var i=a(66699),s=a(898781);const n=(e,t)=>{const a=t||0,i=10**a,s=+(a?e*i:e).toFixed(8),n=Math.floor(s),o=s-n,r=o>.5-1e-8&&o<.5+1e-8?n%2==0?n:n+1:Math.round(s);return a?r/i:r},o=e=>{try{(0).toLocaleString([e])}catch(t){return!1}return!0};function r(){const e=(0,s.ZP)();return(t,a,s)=>{let r=0,l=0;const d=s&&s.style||void 0,h=s&&s.shortform||!1,c=s&&s.uplimit||void 0,u=s&&s.currency||void 0,p=!!c&&a>=c,m=c&&p?c:a;if("currency"===d){const{minimumFractionDigits:e,maximumFractionDigits:a}=((e,t)=>{if(t){const{minimumFractionDigits:a,maximumFractionDigits:i}=new Intl.NumberFormat(e,{style:"currency",currency:t}).resolvedOptions();if(void 0!==a&&void 0!==i)return{minimumFractionDigits:a,maximumFractionDigits:i}}return{minimumFractionDigits:2,maximumFractionDigits:2}})(t,u);r=void 0===s||void 0===s.maximum_fraction_digits?a:s.maximum_fraction_digits,l=void 0===s||void 0===s.minimum_fraction_digits?e:s.minimum_fraction_digits}else r=void 0===s||void 0===s.maximum_fraction_digits?0:s.maximum_fraction_digits,l=void 0===s||void 0===s.minimum_fraction_digits?0:s.minimum_fraction_digits;if(h&&m>999&&(r=void 0===s||void 0===s.shortform_maximum_fraction_digits?2:s.shortform_maximum_fraction_digits,l=0),r<l)return String(m);let y=m,b="";const v=[{"100M":{value:1e8,localeKey:e.bt("億", "億", "Abbreviation for one hundred millions. This abbreviation is only used in Chinese, Japanese and Korean.", undefined, true)}},{"10k":{value:1e4,localeKey:e.bt("万", "万", "Abbreviation for ten thousand. This abbreviation is only used in Chinese, Japanese and Korean.", undefined, true)}}],g=[{b:{value:1e9,localeKey:e.bt("B", "B", "Abbreviation for one billion.", undefined, true)}},{m:{value:1e6,localeKey:e.bt("M", "M", "Abbreviation for one million.", undefined, true)}},{k:{value:1e3,localeKey:e.bt("k", "k", "Abbreviation for one thousand.", undefined, true)}}],P=/^zh|ja|ko/.test(t);if(h&&m>999){const e=P?v:g;for(let t=0;t<e.length;t+=1){const a=Object.keys(e[t])[0],i=e[t][a].value;if(m>=i){y=n(m/i*Math.pow(10,r))/Math.pow(10,r),b=e[t][a].localeKey;break}}}if(null==y)return"";const S=y.toLocaleString([o(t)&&"ar-SA"!==t?t:"en-US"],(({maximumFractionDigits:e,minimumFractionDigits:t,style:a,currency:i})=>{const s={maximumFractionDigits:e,minimumFractionDigits:t};return a?{...s,style:a,..."currency"===a?{currency:i,currencyDisplay:"symbol"}:{}}:s})({maximumFractionDigits:r,minimumFractionDigits:l,currency:u,style:d}));return b&&b.length>0?(0,i.Z)(e.bt("{{formattedNumber}}{{numberSuffix}}", "{{formattedNumber}}{{numberSuffix}}", "i18n.usePrettyNumberFormat.prettyNumberFormat", undefined, true),{formattedNumber:S,numberSuffix:b})+(p?"+":""):S+(p?"+":"")}}},307061:(e,t,a)=>{a.d(t,{Z:()=>i});const i=function(e){return function(t){return null!=t?e(t):null}}},802933:(e,t,a)=>{a.d(t,{Z:()=>i});const i=(0,a(307061).Z)((e=>e.pin&&e.pin.id?{...e,id:e.id,aggregatedPinData:e.pin.aggregated_pin_data}:null))},562559:(e,t,a)=>{a.d(t,{Z:()=>P});var i=a(667294),s=a(867631),n=a.n(s),o=a(112690),r=a(19121),l=a(494349),d=a(773285),h=a(780280),c=a(883119),u=a(969315),p=a(179888),m=a(785893);function y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const b=(e,t)=>{if(t){const a="control"===t?"v3.pinimg.com":"v2.pinimg.com";return e.replace("v.pinimg.com",a)}return e},v=(e,t)=>"string"==typeof e?b(e,t):Array.isArray(e)?((e,t)=>e[0].src&&t?[{...e[0],src:b(e[0].src,t)}]:e)(e,t):e;class g extends i.PureComponent{constructor(...e){super(...e),y(this,"state",{canPlayVideo:!1,isManifestParsed:!1,playbackState:p.Cy.DEFAULT}),y(this,"errorRetryCount",1),y(this,"firstFragBuffered",!1),y(this,"hasPlaybackStarted",!1),y(this,"hasVideoSessionStarted",!1),y(this,"hasVideoSessionEnded",!1),y(this,"hls",null),y(this,"fragStartupTime",{}),y(this,"lastLevelSwitchKbps",null),y(this,"lastStallTime",null),y(this,"lastPauseTime",null),y(this,"logSessionStartOnNextPlay",!1),y(this,"playerId",""),y(this,"videoSessionId",""),y(this,"videoVisibleTime",null),y(this,"playbackPerformance",{canPlayTime:null,detailedErrors:"",downloadedKiloBytes:0,errorCode:0,errorName:"",errorReason:"",hasFatalError:!1,loadStartTime:null,numberOfStalls:0,numberOfSeeks:0,playbackStartTimestamp:null,segments:[],srcString:"string"==typeof this.props.src?b(this.props.src,this.props.quicExpGroup):b(this.props.src[0].src,this.props.quicExpGroup),totalStallDurationMs:0,totalPauseDurationMs:0,videoCreatedTime:null}),y(this,"initializeHls",(()=>{this.destroyHls();const{src:e,hlsConfig:t,quicExpGroup:a}=this.props,i=new(n())(t),s=v(e,a);i.loadSource(s),this.videoPlayerRef&&i.attachMedia(this.videoPlayerRef.video),i.on(n().Events.FRAG_BUFFERED,this.handleHlsFragBuffered),i.on(n().Events.FRAG_CHANGED,this.handleHlsFragChanged),i.on(n().Events.FRAG_LOADING,this.handleHlsFragLoading),i.on(n().Events.FRAG_LOADED,this.handleHlsFragLoaded),i.on(n().Events.MANIFEST_PARSED,(()=>{this.setState({isManifestParsed:!0})})),i.on(n().Events.LEVEL_SWITCHED,this.handleHlsLevelSwitched),i.on(n().Events.ERROR,this.handleHlsError),this.hls=i})),y(this,"destroyHls",(()=>{const{hls:e}=this;e&&e.destroy()})),y(this,"addSegment",(e=>{const{segments:t}=this.playbackPerformance,a=t&&t[t.length-1];if(this.hls&&t.length&&a&&a.uri!==e.url){this.updateWatchDurationForCurrentSegment();const a=this.videoPlayerRef&&this.videoPlayerRef.video,i=this.hls&&this.hls.levels||{},s="number"==typeof e.level?i[e.level]:{},n=this.fragStartupTime[e.url];let o=-1;n&&n.startLoadTime&&n.endLoadTime&&(o=n.endLoadTime-n.startLoadTime);const r={indicatedKbps:s.bitrate/p.bR,duration:e.duration,level:e.level,lastStartPlayTime:this.getCurrentVideoTime(),numServerAddressChange:-1,observedKbps:this.hls&&this.hls.bandwidthEstimate/p.bR||-1,playbackStartDate:Date.now(),serverAddress:"",sn:e.sn,sourceWidth:s.width,sourceHeight:s.height,startupTimeMs:o,switchBitrateKbps:this.lastLevelSwitchKbps||-1,uri:e.url,viewportWidth:a&&a.clientWidth||-1,viewportHeight:a&&a.clientHeight||-1,watchedDurationMs:0};t.push(r)}})),y(this,"initializeSegments",(e=>{const{contextLogData:t={}}=this.props,{is_closeup_video:a=!1}=t,{segments:i}=this.playbackPerformance;if(!i.length)if(this.hls&&this.videoPlayerRef&&this.videoPlayerRef.video&&e){if(!i.length&&"number"==typeof e.level){const t=this.videoPlayerRef&&this.videoPlayerRef.video,a=this.hls.levels,s="number"==typeof e.level?a[e.level]:{},n=this.fragStartupTime[e.url];let o=-1;n&&n.startLoadTime&&n.endLoadTime&&(o=n.endLoadTime-n.startLoadTime),this.lastLevelSwitchKbps=this.hls.bandwidthEstimate/p.bR;const r={indicatedKbps:s.bitrate/p.bR,duration:e.duration,level:e.level,lastStartPlayTime:null,numServerAddressChange:-1,observedKbps:this.hls.bandwidthEstimate/p.bR||-1,playbackStartDate:null,serverAddress:"",sn:e.sn,sourceWidth:s.width,sourceHeight:s.height,startupTimeMs:o,switchBitrateKbps:this.lastLevelSwitchKbps||-1,uri:e.url,viewportWidth:t.clientWidth,viewportHeight:t.clientHeight,watchedDurationMs:0};i.push(r)}}else(0,u.tE)("initializeSegmentsFailed",!0,a)})),y(this,"getCurrentVideoTime",(()=>this.videoPlayerRef&&this.videoPlayerRef.video?this.videoPlayerRef.video.currentTime*p.gJ:null)),y(this,"handleCanPlayVideo",(e=>{const{contextLogData:t={},onReady:a,playing:i}=this.props,{is_closeup_video:s=!1}=t,{canPlayVideo:n}=this.state;(0,u.tE)("handleCanPlayVideo",!0,s,{firstCanPlayEvent:!n,playing:i}),this.playbackPerformance.hasFatalError=!1,n||(this.playbackPerformance.canPlayTime=new Date),this.setState({canPlayVideo:!0}),a&&a(e)})),y(this,"handleEnded",(e=>{const{loop:t,onEnded:a}=this.props,{segments:i}=this.playbackPerformance,s=i&&i[i.length-1];t&&this.videoPlayerRef&&this.videoPlayerRef.video?(this.updateWatchDurationForCurrentSegment(),s&&(s.lastStartPlayTime=0),this.fragStartupTime={}):t||this.logPlaybackPerformance(p.$f,{initiator:"videoEnded",loop:t}),this.setState({playbackState:p.Cy.ENDED}),a&&a(e)})),y(this,"handleHlsError",((e,t)=>{var a;const{contextLogData:i={}}=this.props,{is_closeup_video:s=!1}=i;if(this.playbackPerformance.detailedErrors+=`${this.playbackPerformance.detailedErrors.length>0?", ":""}${t.details}`,t.fatal){var o,r,l,d;this.playbackPerformance.hasFatalError=!0,this.playbackPerformance.errorName=t.type,this.playbackPerformance.errorReason=t.details,this.playbackPerformance.errorCode=t.response&&t.response.code?t.response.code:0;const e={errorName:t.type,errorReason:t.details,errorRetryCount:this.errorRetryCount,errorMessage:(null===(o=t.err)||void 0===o||null===(r=o.message)||void 0===r?void 0:r.slice(0,50))||"unknown",errorResponse:(null===(l=t.response)||void 0===l||null===(d=l.text)||void 0===d?void 0:d.slice(0,50))||"unknown",playbackState:this.state.playbackState};if((0,u.tE)("fatalError",!0,s,e),this.errorRetryCount>0)switch(this.errorRetryCount-=1,t.type){case n().ErrorTypes.NETWORK_ERROR:if(t.details===n().ErrorDetails.MANIFEST_LOAD_ERROR||t.details===n().ErrorDetails.MANIFEST_LOAD_TIMEOUT||t.details===n().ErrorDetails.MANIFEST_LOAD_PARSING_ERROR){var h;const{src:e,quicExpGroup:t}=this.props,a=v(e,t);null===(h=this.hls)||void 0===h||h.loadSource(a)}else{var c;null===(c=this.hls)||void 0===c||c.startLoad()}break;case n().ErrorTypes.MEDIA_ERROR:null===(a=this.hls)||void 0===a||a.recoverMediaError()}}this.updateWatchDurationForCurrentSegment(),this.setState({playbackState:p.Cy.FAILED})})),y(this,"handleHlsFragBuffered",((e,t)=>{this.firstFragBuffered||(this.initializeSegments(t.frag),this.firstFragBuffered=!0)})),y(this,"handleHlsFragChanged",((e,t)=>{this.addSegment(t.frag)})),y(this,"handleHlsFragLoading",((e,t)=>{var a;const i=null===(a=t.frag)||void 0===a?void 0:a.url;i&&!this.fragStartupTime[i]&&(this.fragStartupTime[i]={startLoadTime:new Date})})),y(this,"handleHlsFragLoaded",((e,t)=>{var a;t.frag&&t.frag.loaded&&(this.playbackPerformance.downloadedKiloBytes+=t.frag.loaded/p.Fm);const i=null===(a=t.frag)||void 0===a?void 0:a.url;i&&this.fragStartupTime[i]&&this.fragStartupTime[i].startLoadTime&&(this.fragStartupTime[i].endLoadTime=new Date)})),y(this,"handleHlsLevelSwitched",(()=>{this.hls&&this.hls.bandwidthEstimate&&(this.lastLevelSwitchKbps=this.hls.bandwidthEstimate/p.bR)})),y(this,"handleLoadedMetadata",(()=>{this.setState({playbackState:p.Cy.LOADED_METADATA})})),y(this,"handleLoadStart",(()=>{this.playbackPerformance.loadStartTime=new Date,this.setState({playbackState:p.Cy.LOAD_START})})),y(this,"handleLoadedData",(()=>{this.setState({playbackState:p.Cy.LOADED_DATA})})),y(this,"handlePlaying",(()=>{this.playbackPerformance.hasFatalError=!1,this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.updateStallDuration(),this.updatePauseDuration(),this.setState({playbackState:p.Cy.PLAYING})})),y(this,"handleUserPause",(e=>{const{onControlsPause:t}=this.props;this.lastPauseTime=new Date,t&&t(e)})),y(this,"handleVideoPause",(()=>{this.state.playbackState!==p.Cy.STALLING&&this.state.playbackState!==p.Cy.SEEKING&&(this.updateWatchDurationForCurrentSegment(),this.lastPauseTime||this.updateStallDuration()),this.setState({playbackState:p.Cy.PAUSED})})),y(this,"handleSeeking",(()=>{this.playbackPerformance.numberOfSeeks+=1;const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&(t.lastStartPlayTime=null),this.state.playbackState!==p.Cy.ENDED&&this.setState({playbackState:p.Cy.SEEKING})})),y(this,"handleStalled",(()=>{null===this.lastStallTime&&this.state.playbackState!==p.Cy.ENDED&&(this.lastStallTime=new Date,this.playbackPerformance.numberOfStalls+=1),this.setState({playbackState:p.Cy.STALLING})})),y(this,"handleTimeUpdate",(e=>{const{onTimeChange:t}=this.props;t&&t(e),this.state.playbackState===p.Cy.PLAYING&&(this.updateWatchDurationForCurrentSegment(),this.setLastSegmentStartPlayTime())})),y(this,"resetPlaybackMetrics",(()=>{this.hasPlaybackStarted=!1,this.hasVideoSessionStarted=!1,this.hasVideoSessionEnded=!0,this.lastLevelSwitchKbps=null,this.lastStallTime=null,this.lastPauseTime=null,this.videoSessionId="",this.videoVisibleTime=null,this.logSessionStartOnNextPlay=!1;const e={...this.playbackPerformance.segments[this.playbackPerformance.segments.length-1],lastStartPlayTime:null,playbackStartDate:null,switchBitrateKbps:-1,watchedDurationMs:0};this.playbackPerformance.detailedErrors="",this.playbackPerformance.downloadedKiloBytes=0,this.playbackPerformance.errorCode=0,this.playbackPerformance.errorName="",this.playbackPerformance.errorReason="",this.playbackPerformance.hasFatalError=!1,this.playbackPerformance.numberOfStalls=0,this.playbackPerformance.numberOfSeeks=0,this.playbackPerformance.playbackStartTimestamp=null,this.playbackPerformance.totalStallDurationMs=0,this.playbackPerformance.segments=[e]})),y(this,"setLastSegmentStartPlayTime",(()=>{const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.lastStartPlayTime&&(t.lastStartPlayTime=this.getCurrentVideoTime())})),y(this,"setLastSegmentPlaybackStartDate",(()=>{const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.playbackStartDate&&(t.playbackStartDate=Date.now())})),y(this,"setPlaybackStartTime",(()=>{this.hasPlaybackStarted||(this.playbackPerformance.playbackStartTimestamp=Date.now(),this.hasPlaybackStarted=!0)})),y(this,"setVideoPlayerRef",(e=>{const{setVideoRef:t}=this.props;if(e&&(t&&t(e),this.videoPlayerRef=e,this.videoPlayerRef.video)){const e=this.videoPlayerRef.video;e.addEventListener("loadedmetadata",this.handleLoadedMetadata),e.addEventListener("loadeddata",this.handleLoadedData),e.addEventListener("pause",this.handleVideoPause),e.readyState>=3&&(this.setState({canPlayVideo:!0}),this.playbackPerformance.canPlayTime=new Date)}})),y(this,"updateStallDuration",(()=>{null!==this.lastStallTime&&(this.playbackPerformance.totalStallDurationMs+=new Date-this.lastStallTime,this.lastStallTime=null)})),y(this,"updatePauseDuration",(()=>{if(null!==this.lastPauseTime){const e=this.lastPauseTime;this.playbackPerformance.totalPauseDurationMs+=new Date-e,this.lastPauseTime=null}})),y(this,"updateWatchDurationForCurrentSegment",(()=>{const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1],a=t?t.lastStartPlayTime:null,i=this.getCurrentVideoTime();if(t&&null!==a&&"number"==typeof i&&"number"==typeof a){const e=i-a;e>0&&(t.watchedDurationMs+=e,t.lastStartPlayTime=null)}})),y(this,"logPlaybackPerformance",((e,t)=>{const{contextLogData:a={},userId:i,isAutoPlay:s,logContextEvent:n}=this.props,{is_closeup_video:o=!1}=a,{canPlayTime:r,detailedErrors:l,downloadedKiloBytes:d,errorCode:h,errorName:c,errorReason:m,hasFatalError:y,playbackStartTimestamp:b,totalPauseDurationMs:v,totalStallDurationMs:g,segments:P,srcString:S,loadStartTime:f,numberOfStalls:D,numberOfSeeks:k}=this.playbackPerformance,E=this.videoPlayerRef&&this.videoPlayerRef.video,w=e===p.DR,T=w&&!this.hasVideoSessionStarted,_=!w&&!this.hasVideoSessionEnded&&this.hasVideoSessionStarted;if(this.hls&&E&&(T||_)){var R;let T=-1;r&&f&&(T=r>f?r-f:0);let _=-1;r&&this.videoVisibleTime&&(_=r>this.videoVisibleTime?r-this.videoVisibleTime:0),w&&(this.videoSessionId=(0,p.Y7)(i),this.playerId=this.playerId||(0,p.EB)());const L={autoplaying:s,averageVideoKbps:-1,detailedErrors:l,downloadedKiloBytes:d,isCellular:!1,errorCode:h,errorName:c,errorReason:m,fatalError:y,nativeVideoDurationMs:E.duration*p.gJ||-1,numberOfStalls:D,numberOfSeeks:k,overallPausedDurationMs:v,overallBufferDurationMs:g,overallWatchedDurationMs:-1,rebufferRate:-1,playbackSessionId:this.videoSessionId,playbackStartTimestamp:b||-1,segments:[],sessionMark:e,screenPixelScale:null!==(R=window)&&void 0!==R&&R.devicePixelRatio?window.devicePixelRatio:-1,startupPlayerWidth:E.clientWidth,startupPlayerHeight:E.clientHeight,startupTimeMs:T,startupLatencyMs:_,startupVariantKbps:-1,startupVariantWatchedDurationMs:-1,startupVariantWidth:E.videoWidth,startupVariantHeight:E.videoHeight,videoUrl:S};if(!w&&P.length){const e=this.hls.levels,t=P[0];this.updateWatchDurationForCurrentSegment(),this.updateStallDuration();const a=P.reduce(((t,a)=>{if(a&&"number"==typeof a.level&&e&&e.length>0){return t+(e[a.level]||{}).bitrate*(a.watchedDurationMs||0)/p.gJ}return t}),0),i=P.reduce(((e,t)=>e+(t.watchedDurationMs||0)),0);let s=null,n=0,o=0;do{n+=P[o].watchedDurationMs,s=s||P[o].level,o+=1}while(o<P.length&&P[o].level===s);L.startupVariantKbps=t.indicatedKbps,L.startupVariantWatchedDurationMs=n,L.startupVariantWidth=t.sourceWidth,L.startupVariantHeight=t.sourceHeight,L.startupPlayerWidth=t.viewportWidth,L.startupPlayerHeight=t.viewportHeight,L.overallWatchedDurationMs=i,i>0?(L.averageVideoKbps=a/(i/p.gJ),L.rebufferRate=this.playbackPerformance.totalStallDurationMs/i):0===i&&(L.averageVideoKbps=-1,L.rebufferRate=-1,L.errorName="invalid_watch_duration"),L.segments=P}else L.errorName="invalid_watch_duration";(0,u.ZP)(L,!0,o,{playbackState:this.state.playbackState,...t});const{clientTrackingParams:C,component:A,durationNs:M,element:I,objectId:x,pairId:V,viewData:F,view:N,viewParameter:O,...W}=a;n({aux_data:{...W,is_closeup_video:o,playback_session_id:this.videoSessionId},clientTrackingParams:C,component:A,duration_ns:M,element:I,event_data:{videoPerformanceData:L},event_type:3606,object_id_str:x,pair_id:V,view_data:F,view_parameter:O,view_type:N}),w?(this.hasVideoSessionStarted=!0,this.hasVideoSessionEnded=!1):this.resetPlaybackMetrics(),(0,u.tE)(w?"sessionStart":"sessionEnd",!0,o,{playbackState:this.state.playbackState,...t})}}))}componentDidMount(){const{contextLogData:e={},playing:t}=this.props,{is_closeup_video:a=!1}=e;this.playbackPerformance.videoCreatedTime=new Date,this.initializeHls(),(0,u.tE)("videoMounted",!0,a),t&&(this.videoVisibleTime=new Date,this.logPlaybackPerformance(p.DR,{initiator:"mount"}))}componentDidUpdate(e){const{loop:t,playing:a,src:i,visible:s,appInFocus:n}=this.props;var o,r;(typeof(o=e.src)!=typeof(r=i)||(Array.isArray(r)?o.length!==r.length||r.some(((e,t)=>!Array.isArray(o)||e.type!==o[t].type||e.src!==o[t].src)):r!==o))&&this.initializeHls(),e.appInFocus&&!n&&(this.logPlaybackPerformance(p.$f,{initiator:"update",loop:t}),this.logSessionStartOnNextPlay=!0),e.visible&&!1===s&&(this.logSessionStartOnNextPlay=!1,this.updatePauseDuration(),this.logPlaybackPerformance(p.$f,{initiator:"update",loop:t})),!1===e.visible&&!0===s&&(this.videoVisibleTime=this.videoVisibleTime||new Date,a?(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(p.DR,{initiator:"update"})):this.logSessionStartOnNextPlay=!0),a&&n&&this.logSessionStartOnNextPlay&&(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(p.DR,{initiator:"update"}),this.logSessionStartOnNextPlay=!1)}componentWillUnmount(){const{loop:e}=this.props;this.updatePauseDuration(),this.logPlaybackPerformance(p.$f,{initiator:"unmount",loop:e}),this.destroyHls()}render(){const{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,backgroundColor:l,captions:d,controls:h,loop:u,loopOverride:p,onDurationChange:y,onFullscreenChange:b,onLoadedChange:g,onControlsPlay:P,onPlayheadDown:S,onPlayheadUp:f,onSeek:D,onVolumeChange:k,playbackRate:E,playing:w,playsInline:T,poster:_,preload:R,quicExpGroup:L,src:C,volume:A}=this.props,{canPlayVideo:M,isManifestParsed:I}=this.state,x=v(C,L);return(0,m.jsx)(c.nk,{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,backgroundColor:l,captions:d,controls:h,loop:void 0===p?u:p,onDurationChange:y,onEnded:this.handleEnded,onFullscreenChange:b,onLoadStart:this.handleLoadStart,onLoadedChange:g,onControlsPause:this.handleUserPause,onControlsPlay:P,onPlaying:this.handlePlaying,onPlayheadDown:S,onPlayheadUp:f,onReady:this.handleCanPlayVideo,onSeek:D,onSeeking:this.handleSeeking,onStalled:this.handleStalled,onTimeChange:this.handleTimeUpdate,onVolumeChange:k,onWaiting:this.handleStalled,playbackRate:E,onPlay:()=>{},onPlayError:()=>{},playing:I&&M&&w,playsInline:T,poster:_,preload:R,ref:this.setVideoPlayerRef,src:x,volume:A})}}const P=(0,i.memo)((function(e){const{country:t,isAuthenticated:a,isBot:i,isSocialBot:s,unauthId:n,userAgent:c}=(0,h.B)(),p=(0,o.Z)(),y=(0,r.Z)(),{browserName:b,browserVersion:v,isMobile:P}=c,{contextLogData:S={}}=e,{is_closeup_video:f=!1,view:D,viewParameter:k}=S,{checkExperiment:E}=(0,d.F)();let w=null;a&&(w=E("web_video_quic").group.length?E("web_video_quic").group:null);const{appUI:T}=(0,l.I)(),_=E("web_video_fail_to_start_fix").anyEnabled?T.appInFocus:e.appInFocus,R={browserName:b,browserVersion:v,country:t,isAuthenticated:a,isBot:i,is_closeup_video:f,isMobile:P,isSocialBot:s,view:D,viewParameter:k};return(0,u.r$)(R),(0,m.jsx)(g,{...e,userId:y.id||n,appInFocus:_,quicExpGroup:w,logContextEvent:p})}))},969315:(e,t,a)=>{a.d(t,{ZP:()=>c,r$:()=>d,tE:()=>h});var i=a(311560),s=a(172071),n=a(179888);const o=["isCellular","videoUrl","sessionMark"];let r={},l="";const d=e=>{const{browserName:t,browserVersion:a,country:s,isAuthenticated:n,isBot:o,isMobile:d,isSocialBot:h,view:c="unknown",viewParameter:u="unknown"}=e;l=(h?"socialBot":o&&"bot")||"nonbot";const p=(0,i.Z)(s);r={browserName:t,browserVersion:(null==a?void 0:a.split(".")[0])||"0",isAuthenticated:n,isMobile:d,region:p,view:c,viewParameter:u}};function h(e,t,a,i={}){const n=a?"closeup":"nonCloseup",o=t?"hls":"nonHls",d={...i,...r},h=`web.video.${o}.${l}.${n}.${e}`;s.Z.increment(h,1,d)}function c(e,t,a,i={}){const d=a?"closeup":"nonCloseup",h=t?"hls":"nonHls",c=e.sessionMark===n.DR?"sessionStart":"sessionEnd",u={...i,...r};if(Object.entries(e).forEach((([t,a])=>{const i=`web.video.${h}.${l}.${d}.${c}.${t}`,n=parseInt(a,10),r="number"==typeof n?n:-1;var p;if(!o.includes(t))if(t.includes("fatalError")&&!0===a){const{errorCode:t,errorName:a,errorReason:n}=e;s.Z.increment(i,1,{errorCode:t,errorName:a,errorReason:n,...u})}else if(t.includes("Width")||t.includes("Height")){const e=(p=r)<0?"negative":0===p?"zero":p<200?"xs":p<400?"s":p<600?"m":p<800?"l":p<1e3?"xl":p<1200?"xxl":"over1200";s.Z.increment(i,1,{dimensionBucket:e,...u})}else if("numberOfStalls"===t){let e=a;r>1e3?e="over1000":r>10?e="over10":r<0&&(e="negative"),s.Z.increment(i,1,{numberOfStalls:e,...u})}else"screenPixelScale"===t?s.Z.increment(i,1,{screenPixelScale:a||-1,...u}):r>=0?(0===r&&s.Z.increment(`${i}.zero`,1,u),s.Z.timing(i,r,1),s.Z.timing(`${i}_with_tags`,r,1,u)):r<0&&s.Z.increment(`${i}.negative`,1,u)})),e.sessionMark!==n.DR){const{rebufferRate:t,screenPixelScale:a,startupLatencyMs:i,startupVariantWidth:n,startupPlayerWidth:o}=e,r=`web.video.${h}.${l}.${d}.${c}`;if("number"==typeof n&&"number"==typeof o&&"number"==typeof a){const e=1.5*n>a*o;s.Z.increment(`${r}.upscaled.${e?"good":"bad"}`,1,u)}"number"==typeof i&&s.Z.increment(`${r}.startupLatency.${i<500?"good":"bad"}`,1,u),"number"==typeof t&&s.Z.increment(`${r}.rebufferRate.${t<.01?"good":"bad"}`,1,u)}}},179888:(e,t,a)=>{a.d(t,{$f:()=>n,Cy:()=>d,DR:()=>s,EB:()=>u,Fm:()=>l,Y7:()=>c,bR:()=>r,gJ:()=>o,lG:()=>h});var i=a(172045);const s=1,n=2,o=1e3,r=1e3,l=1e3,d=Object.freeze({DEFAULT:0,LOAD_START:1,LOADED_METADATA:2,LOADED_DATA:3,PLAYING:4,PAUSED:5,SEEKING:6,STALLING:7,FAILED:8,ENDED:9}),h=Object.freeze({MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4});function c(e){return e+"-"+(0,i.Z)()}function u(){return(0,i.Z)()}},121630:(e,t,a)=>{a.d(t,{Z:()=>n,e:()=>s});var i=a(81226);const s=e=>{if("undefined"==typeof window)return"";let t=0;const a=document.querySelector('[data-test-id="header"]');if(null!==a){const{height:e}=a.getBoundingClientRect();t+=e}switch(e){case"AuthHomefeed":const e=document.querySelector('[data-root-margin="more-ideas-tabs"]');if(null!==e){const{height:a}=e.getBoundingClientRect();t+=a}break;case"SearchItem":const a=document.querySelector('[data-root-margin="search-improvements-bar"]');if(null!==a){const{height:e}=a.getBoundingClientRect();t+=e}const i=document.querySelector('[data-test-id="search-tab-bar"],[data-root-margin="search-one-bar"]');if(null!==i){const{height:e}=i.getBoundingClientRect();t+=e}}return-1*t+"px 0px 0px 0px"},n=e=>{var t,a,s,n,o;return(0,i.Z)((null===(t=e.videos)||void 0===t?void 0:t.duration)||(null===(a=e.videos)||void 0===a||null===(s=a.video_list)||void 0===s||null===(n=s.V_HLSV4)||void 0===n?void 0:n.duration)||(null===(o=e.story_pin_data)||void 0===o?void 0:o.total_video_duration)||0)}},61877:(e,t,a)=>{a.d(t,{Cq:()=>p,Dk:()=>y,Fk:()=>n,bI:()=>s,fS:()=>u,gw:()=>h,j1:()=>c,km:()=>m,lI:()=>r,lJ:()=>o,mS:()=>d,qW:()=>l,t5:()=>b});var i=a(883119);const s=new i.Ry(0),n=new i.Ry(1),o=3,r=new i.Ry(o),l=2,d=new i.Ry(l),h=new i.Ry(3),c=new i.Ry(3),u=3,p=4,m=new i.Ry(5),y=new i.Ry(100),b=new i.Ry(l)},837727:(e,t,a)=>{a.d(t,{d:()=>i});const i={BOARD:"board",PIN:"pin",DID_IT:"did_it",PINNER:"pinner",USER:"user",TODAY_ARTICLE:"today_article"}},572260:(e,t,a)=>{a.d(t,{ZP:()=>E});var i=a(667294),s=a(23279),n=a.n(s),o=a(722767);function r(e){const{eventData:{videoEvent:{videoDuration:t,startTime:a,endTime:i,videoStartTime:s,videoEndTime:n,isAudible:o,height:r,width:l,playbackState:d,quartile:h,quartilePercentValue:c,windowHeight:u,windowWidth:p,viewability:m}},component:y,objectId:b,view:v,viewParameter:g,...P}=e;return{component:y,object_id_str:b,view_type:v,view_parameter:g,aux_data:{...P},event_data:{videoEventData:{videoDuration:t,time:a,endTime:i,videoTime:s,endVideoTime:n,isAudible:o,height:r,width:l,playbackState:d,quartile:h,quartilePercentValue:c,windowHeight:u,windowWidth:p,viewability:m}}}}var l=a(121630),d=a(559230),h=a(407043),c=a(288273),u=a(883119),p=a(785893);function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const y=[0,.25,.5,.75,.95,.97],b=[0,.5,.8,.99,1],v="-64px 0px 0px 0px",g={rootMargin:v,threshold:b},P={rootMargin:v,threshold:d.iM},S=Object.freeze({LOADING:0,PLAYING:1,PAUSED:2,STALLING:3});function f(){return(new Date).getTime()}function D(e){return!!e.volume&&e.volume>0}class k extends i.Component{constructor(e){super(e),m(this,"videoWrapperRef",(0,i.createRef)()),m(this,"handleWindowResize",(()=>{if(!this.fullscreen){const e=this.getDimensions(),{height:t,width:a}=this.currentInterval;e.height!==t||e.width!==a?this.startNewInterval(e):(this.currentInterval.windowHeight=e.windowHeight,this.currentInterval.windowWidth=e.windowWidth)}})),m(this,"handlePlayheadDown",(({event:e})=>{const{onPlayheadDown:t}=this.props;this.setState({seeking:!0}),t&&t({event:e})})),m(this,"handlePlayheadUp",(({event:e})=>{const{onPlayheadUp:t}=this.props;this.setState({seeking:!1}),t&&t({event:e})})),m(this,"handleLoop",(()=>{this.videoTime=0})),m(this,"handleTimeChange",(e=>{const{seeking:t,ready:a}=this.state;if(!this.currentInterval.videoDuration)return;const i=1e3*e.time,s=function(e,t,a,i){if(e>t)return null;if(a<=0)return null;for(const s of i){const i=s*a;if(e<=i&&t>i)return s}return null}(this.videoTime,i,this.currentInterval.videoDuration,y);if("number"==typeof s&&this.props.playing&&!t&&a){const e=f();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*s),quartilePercentValue:s})}this.videoTime=i,this.props.onTimeChange&&this.props.onTimeChange(e)})),m(this,"handleDurationChange",(e=>{this.currentInterval.videoDuration=1e3*e.duration,this.props.onDurationChange&&this.props.onDurationChange(e)})),m(this,"handleReady",(e=>{const{ready:t}=this.state;t||this.setState({ready:!0}),this.props.onReady&&this.props.onReady(e)})),m(this,"handleEnded",(e=>{this.logFourthQuartileEvent(),this.props.loop&&(this.startNewInterval(),this.currentInterval.videoStartTime=0),this.props.onEnded&&this.props.onEnded(e)})),m(this,"handleVisibilityChange",((e,t)=>{if(0===e.length)return;const a=e.slice(-1)[0],i=function(e,t){for(let a=0;a<t.length;a+=1){const i=t[a],s=t[a+1];if(null==s)return i;if(i<=e&&e<s)return i}return null}(Number.parseFloat(a.intersectionRatio.toFixed(2)),b);"number"==typeof i&&(this.visible=i>=.5),null==i||i===this.currentInterval.viewability||this.fullscreen||(0===i?this.startNewInterval({viewability:i,playbackState:S.PAUSED}):this.startNewInterval({viewability:i}))})),m(this,"handleFullscreenChange",(({event:e,fullscreen:t})=>{if(t){const{height:e,width:t}=window.screen;this.startNewInterval({height:e,width:t,windowHeight:e,windowWidth:t})}else t||this.startNewInterval(this.getDimensions());this.fullscreen=t,this.props.onFullscreenChange&&this.props.onFullscreenChange({event:e,fullscreen:t})})),m(this,"handleClose",(()=>{this.startNewInterval()})),m(this,"handleContextMenu",(e=>{e.preventDefault()})),this.state={ready:!1,seeking:!1};const t=f();this.handleWindowResize=n()(this.handleWindowResize,1e3),this.currentInterval={videoDuration:0,startTime:t,endTime:t,videoStartTime:0,videoEndTime:0,isAudible:D(e),playbackState:this.getPlaybackState(e,this.state),quartile:-1,quartilePercentValue:0,height:null,width:null,windowHeight:null,windowWidth:null,viewability:null},this.videoTime=0,this.fullscreen=!1,this.visible=null}componentDidMount(){this.currentInterval={...this.currentInterval,...this.getDimensions()},window.addEventListener("resize",this.handleWindowResize),window.addEventListener("beforeunload",this.handleClose)}componentDidUpdate(e,t){const a={};D(e)&&!D(this.props)?a.isAudible=!1:!D(e)&&D(this.props)&&(a.isAudible=!0);const i=this.getPlaybackState(this.props,this.state);this.getPlaybackState(e,t)!==i&&(a.playbackState=i),Object.keys(a).length>0&&this.startNewInterval(a)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("beforeunload",this.handleClose),this.startNewInterval()}getPlaybackState(e,t){return t.ready?e.playing&&!t.seeking?S.PLAYING:S.PAUSED:S.LOADING}getDimensions(){let e,t;if(this.videoWrapperRef.current){const a=this.videoWrapperRef.current;a.clientHeight&&a.clientWidth&&(e=a.clientHeight,t=a.clientWidth)}return{height:e,width:t,windowHeight:window.innerHeight,windowWidth:window.innerWidth}}logVideoEvent(e,t){const{closeupStoryPinViewability:a,contextLogData:i,logContextEvent:s}=this.props,{height:n,width:o,windowHeight:l,windowWidth:d,viewability:h,...c}=t;if(null!=n&&null!=o&&null!=l&&null!=d&&null!=h){const t={...c,height:n,width:o,windowHeight:l,windowWidth:d,viewability:a||h};s({event_type:e,...r({...i,view:this.fullscreen?108:i.view,eventData:{videoEvent:t}})})}}logFourthQuartileEvent(){const e=f();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:4,quartilePercentValue:1})}startNewInterval(e){const t=f();this.logVideoEvent(6904,{...this.currentInterval,endTime:t,videoEndTime:this.videoTime}),this.currentInterval={...this.currentInterval,...e,startTime:t,videoStartTime:this.videoTime,endTime:-1,videoEndTime:-1}}render(){const{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:r,aspectRatio:d,backgroundColor:h,captions:m,contextLogData:y,controls:b,cropHeight:v,hlsConfig:S,inAdsDesktopVideoExperiment:f,isAutoPlay:D,loop:k,objectFit:E,onLoadedChange:w,onControlsPause:T,onControlsPlay:_,onSeek:R,onVolumeChange:L,playbackRate:C,playing:A,playsInline:M,poster:I,preload:x,rootMargin:V,src:F,surface:N,videoStartTime:O,volume:W}=this.props,{seeking:H}=this.state,B=f?P:g;return void 0!==V&&(B.rootMargin=N?(0,l.e)(N):V),(0,p.jsx)(o.Z,{options:B,onVisibilityChange:this.handleVisibilityChange,children:(0,p.jsx)(u.xu,{ref:this.videoWrapperRef,onContextMenu:this.handleContextMenu,dangerouslySetInlineStyle:{__style:v?{display:"flex",alignItems:"center",height:`${v}px`}:{}},children:(0,p.jsx)(c.default,{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:r,aspectRatio:v?236/v:d,backgroundColor:h,captions:m,contextLogData:y,controls:b,hlsConfig:S,isAutoPlay:D,loop:k,objectFit:E,onDurationChange:this.handleDurationChange,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onLoadedChange:w,onLoop:this.handleLoop,onControlsPause:T,onControlsPlay:_,onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onReady:this.handleReady,onSeek:R,onTimeChange:this.handleTimeChange,onVolumeChange:L,playbackRate:C,playing:!H&&A,onPlay:()=>{},onPlayError:()=>{},playsInline:M,poster:I,preload:x,src:F,videoStartTime:O,visible:this.visible,volume:W})})})}}function E(e){const{logContextEvent:t}=(0,h.v)();return(0,p.jsx)(k,{...e,logContextEvent:t})}m(k,"defaultProps",u.nk.defaultProps)},288273:(e,t,a)=>{a.r(t),a.d(t,{VideoWrapper:()=>f,default:()=>D,getPlaylistSourceSrc:()=>S});var i=a(667294),s=a(19121),n=a(494349),o=a(407043),r=a(773285),l=a(780280),d=a(883119),h=a(969315),c=a(179888),u=a(785893);function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function m(e,t){if(!e||void 0===e)return"undefined";if("string"==typeof e){let a=e;if(t){const i="control"===t?"v3.pinimg.com":"v2.pinimg.com";a=e.replace("v.pinimg.com",i)}return a}if(Array.isArray(e)&&e[0].src){let a=e[0].src;if(t){const e="control"===t?"v3.pinimg.com":"v2.pinimg.com";a=a.replace("v.pinimg.com",e)}return a}return"unsupported_type_"+typeof e}class y extends i.Component{constructor(...e){super(...e),p(this,"state",{canPlayVideo:!1,playbackState:c.Cy.DEFAULT}),p(this,"errorRetryCount",2),p(this,"hasSegmentStarted",!1),p(this,"hasPlaybackStarted",!1),p(this,"hasVideoSessionStarted",!1),p(this,"hasVideoSessionEnded",!1),p(this,"lastStallTime",null),p(this,"lastPauseTime",null),p(this,"logSessionStartOnNextPlay",!1),p(this,"playerId",""),p(this,"videoSessionId",""),p(this,"videoVisibleTime",null),p(this,"playbackPerformance",{canPlayTime:null,detailedErrors:"",errorCode:0,errorName:"",errorReason:"",hasFatalError:!1,loadStartTime:null,numberOfStalls:0,numberOfSeeks:0,playbackStartTimestamp:null,segments:[],srcString:m(this.props.src,this.props.quicExpGroup),totalStallDurationMs:0,totalPauseDurationMs:0}),p(this,"componentDidMount",(()=>{const{contextLogData:e={},playing:t}=this.props,{is_closeup_video:a=!1}=e;(0,h.tE)("videoMounted",!1,a),t&&(this.videoVisibleTime=new Date,this.logPlaybackPerformance(c.DR,{initiator:"mount"}))})),p(this,"componentDidUpdate",(e=>{const{playing:t,visible:a,appInFocus:i}=this.props;e.appInFocus&&!i&&(this.logPlaybackPerformance(c.$f,{initiator:"update"}),this.logSessionStartOnNextPlay=!0),e.visible&&!1===a&&(this.logSessionStartOnNextPlay=!1,this.updatePauseDuration(),this.logPlaybackPerformance(c.$f,{initiator:"update"})),!1===e.visible&&!0===a&&(this.videoVisibleTime=this.videoVisibleTime||new Date,t?(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(c.DR,{initiator:"update"})):this.logSessionStartOnNextPlay=!0),t&&i&&this.logSessionStartOnNextPlay&&(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(c.DR,{initiator:"update"}),this.logSessionStartOnNextPlay=!1)})),p(this,"addSegment",(()=>{const{canPlayTime:e,loadStartTime:t,segments:a,srcString:i}=this.playbackPerformance;let s=-1;e&&t&&0===a.length&&(s=e>t?e-t:0);const n=this.videoPlayerRef&&this.videoPlayerRef.video,o={indicatedKbps:-1,duration:n&&n.duration*c.gJ||-1,lastStartPlayTime:null,level:-1,numServerAddressChange:-1,observedKbps:-1,playbackStartDate:null,serverAddress:"",sourceWidth:-1,sourceHeight:-1,startupTimeMs:s,switchBitrateKbps:-1,uri:i,viewportWidth:n&&n.clientWidth||-1,viewportHeight:n&&n.clientHeight||-1,watchedDurationMs:0};a.push(o)})),p(this,"getCurrentVideoTime",(()=>this.videoPlayerRef&&this.videoPlayerRef.video?this.videoPlayerRef.video.currentTime*c.gJ:0)),p(this,"getVideoResourceTiming",(()=>{var e,t;if(null!==(e=window)&&void 0!==e&&null!==(t=e.performance)&&void 0!==t&&t.getEntriesByName&&this.playbackPerformance.srcString){const e=window.performance.getEntriesByName(this.playbackPerformance.srcString);return e.length>0&&e[0]||null}return null})),p(this,"handleCanPlayVideo",(e=>{const{contextLogData:t={},onReady:a,playing:i,videoStartTime:s}=this.props,{is_closeup_video:n=!1}=t,{canPlayVideo:o}=this.state;(0,h.tE)("handleCanPlayVideo",!1,n,{firstCanPlayEvent:!o,playing:i}),this.playbackPerformance.hasFatalError=!1,o||(this.playbackPerformance.canPlayTime=new Date,null!=s&&this.videoPlayerRef&&this.videoPlayerRef.video&&(this.videoPlayerRef.video.currentTime=s)),this.setState({canPlayVideo:!0}),a&&a(e)})),p(this,"handleEnded",(e=>{const{loop:t,onEnded:a}=this.props,{segments:i}=this.playbackPerformance,s=i&&i[i.length-1];t&&this.videoPlayerRef&&this.videoPlayerRef.video?(this.updateWatchDurationForCurrentSegment(),s&&(s.lastStartPlayTime=0),this.hasSegmentStarted=!1):t||this.logPlaybackPerformance(c.$f,{initiator:"videoEnded",loop:t}),this.setState({playbackState:c.Cy.ENDED}),a&&a(e)})),p(this,"handleError",(()=>{var e,t,a,i,s,n,o,r;const{contextLogData:l={}}=this.props,{is_closeup_video:d=!1}=l,u=this.videoPlayerRef&&this.videoPlayerRef.video;(null==u||null===(e=u.error)||void 0===e?void 0:e.code)!==c.lG.MEDIA_ERR_ABORTED&&(this.playbackPerformance.hasFatalError=!0),this.playbackPerformance.detailedErrors+=`${this.playbackPerformance.detailedErrors.length>0?", ":""}${(null==u||null===(t=u.error)||void 0===t?void 0:t.message)||""}`,this.playbackPerformance.errorCode=(null==u||null===(a=u.error)||void 0===a?void 0:a.code)||0,this.playbackPerformance.errorName=(null==u||null===(i=u.error)||void 0===i||null===(s=i.message)||void 0===s?void 0:s.slice(0,100))||"unknown",this.playbackPerformance.errorReason=(null==u||null===(n=u.error)||void 0===n||null===(o=n.message)||void 0===o?void 0:o.slice(0,100))||"unknown";const p={errorName:this.playbackPerformance.errorCode,errorReason:this.playbackPerformance.errorName,errorRetryCount:this.errorRetryCount,playbackState:this.state.playbackState,networkState:(null==u?void 0:u.networkState)||"unknown"};switch((0,h.tE)("fatalError",!1,d,p),null==u||null===(r=u.error)||void 0===r?void 0:r.code){case c.lG.MEDIA_ERR_ABORTED:break;case c.lG.MEDIA_ERR_NETWORK:case c.lG.MEDIA_ERR_DECODE:case c.lG.MEDIA_ERR_SRC_NOT_SUPPORTED:default:this.errorRetryCount>0&&(null==u||u.load(),this.errorRetryCount-=1)}this.updateWatchDurationForCurrentSegment(),this.setState({playbackState:c.Cy.FAILED})})),p(this,"handleLoadedMetadata",(()=>{this.setState({playbackState:c.Cy.LOADED_METADATA})})),p(this,"handleLoadStart",(()=>{this.playbackPerformance.loadStartTime=new Date,this.setState({playbackState:c.Cy.LOAD_START})})),p(this,"handleLoadedData",(()=>{this.setState({playbackState:c.Cy.LOADED_DATA})})),p(this,"handlePlaying",(()=>{this.playbackPerformance.hasFatalError=!1,this.setPlaybackStartTime(),this.hasSegmentStarted||this.addSegment(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.updateStallDuration(),this.updatePauseDuration(),this.setState({playbackState:c.Cy.PLAYING})})),p(this,"handleUserPause",(e=>{const{onControlsPause:t}=this.props;this.lastPauseTime=new Date,t&&t(e)})),p(this,"handleVideoPause",(()=>{this.state.playbackState!==c.Cy.STALLING&&this.state.playbackState!==c.Cy.SEEKING&&(this.updateWatchDurationForCurrentSegment(),this.lastPauseTime||this.updateStallDuration()),this.setState({playbackState:c.Cy.PAUSED})})),p(this,"handleSeeking",(()=>{this.playbackPerformance.numberOfSeeks+=1;const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&(t.lastStartPlayTime=null),this.state.playbackState!==c.Cy.ENDED&&this.setState({playbackState:c.Cy.SEEKING})})),p(this,"handleStalled",(()=>{null===this.lastStallTime&&this.state.playbackState!==c.Cy.ENDED&&(this.lastStallTime=new Date,this.playbackPerformance.numberOfStalls+=1,this.setState({playbackState:c.Cy.STALLING}))})),p(this,"handleTimeUpdate",(e=>{const{onTimeChange:t}=this.props;t&&t(e),this.state.playbackState===c.Cy.PLAYING&&(this.updateWatchDurationForCurrentSegment(),this.setLastSegmentStartPlayTime())})),p(this,"resetPlaybackMetrics",(()=>{this.hasSegmentStarted=!0,this.hasPlaybackStarted=!1,this.hasVideoSessionStarted=!1,this.hasVideoSessionEnded=!0,this.lastStallTime=null,this.lastPauseTime=null,this.videoSessionId="",this.videoVisibleTime=null,this.logSessionStartOnNextPlay=!1;const e={...this.playbackPerformance.segments[this.playbackPerformance.segments.length-1],lastStartPlayTime:null,playbackStartDate:null,watchedDurationMs:0};this.playbackPerformance.detailedErrors="",this.playbackPerformance.errorCode=0,this.playbackPerformance.errorName="",this.playbackPerformance.errorReason="",this.playbackPerformance.hasFatalError=!1,this.playbackPerformance.numberOfStalls=0,this.playbackPerformance.numberOfSeeks=0,this.playbackPerformance.playbackStartTimestamp=null,this.playbackPerformance.totalStallDurationMs=0,this.playbackPerformance.segments=[e]})),p(this,"setLastSegmentStartPlayTime",(()=>{const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.lastStartPlayTime&&(t.lastStartPlayTime=this.getCurrentVideoTime())})),p(this,"setLastSegmentPlaybackStartDate",(()=>{const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.playbackStartDate&&(t.playbackStartDate=Date.now())})),p(this,"setPlaybackStartTime",(()=>{this.hasPlaybackStarted||(this.playbackPerformance.playbackStartTimestamp=Date.now(),this.hasPlaybackStarted=!0)})),p(this,"setVideoPlayerRef",(e=>{const{setVideoRef:t}=this.props;if(e&&(t&&t(e),this.videoPlayerRef=e,this.videoPlayerRef.video)){const e=this.videoPlayerRef.video;e.addEventListener("loadedmetadata",this.handleLoadedMetadata),e.addEventListener("loadeddata",this.handleLoadedData),e.addEventListener("pause",this.handleVideoPause),e.readyState>=3&&(this.setState({canPlayVideo:!0}),this.playbackPerformance.canPlayTime=new Date)}})),p(this,"updateStallDuration",(()=>{if(null!==this.lastStallTime){const e=this.lastStallTime;this.playbackPerformance.totalStallDurationMs+=new Date-e,this.lastStallTime=null}})),p(this,"updatePauseDuration",(()=>{if(null!==this.lastPauseTime){const e=this.lastPauseTime;this.playbackPerformance.totalPauseDurationMs+=new Date-e,this.lastPauseTime=null}})),p(this,"updateWatchDurationForCurrentSegment",(()=>{const{segments:e}=this.playbackPerformance,t=e&&e[e.length-1],a=t?t.lastStartPlayTime:null,i=this.getCurrentVideoTime();if(t&&null!==a&&"number"==typeof i&&"number"==typeof a){const e=i-a;e>0&&(t.watchedDurationMs+=e,t.lastStartPlayTime=null)}})),p(this,"logPlaybackPerformance",((e,t)=>{const{contextLogData:a={},userId:i,isAutoPlay:s,logContextEvent:n}=this.props,{is_closeup_video:o=!1}=a,{canPlayTime:r,detailedErrors:l,errorCode:d,errorName:u,errorReason:p,hasFatalError:m,loadStartTime:y,totalPauseDurationMs:b,totalStallDurationMs:v,numberOfStalls:g,numberOfSeeks:P,playbackStartTimestamp:S,segments:f,srcString:D}=this.playbackPerformance,k=this.videoPlayerRef&&this.videoPlayerRef.video,E=e===c.DR,w=E&&!this.hasVideoSessionStarted,T=!E&&!this.hasVideoSessionEnded&&this.hasVideoSessionStarted;if(k&&(w||T)){var _;let w=-1;r&&y&&(w=r>y?r-y:0);let T=-1;r&&this.videoVisibleTime&&(T=r>this.videoVisibleTime?r-this.videoVisibleTime:0),E&&(this.videoSessionId=(0,c.Y7)(i),this.playerId=this.playerId||(0,c.EB)());const R=this.getVideoResourceTiming(),L={averageVideoKbps:-1,autoplaying:s,detailedErrors:l,downloadedKiloBytes:"number"==typeof(null==R?void 0:R.decodedBodySize)&&R.decodedBodySize/c.Fm||0,errorCode:d,errorName:u,errorReason:p,fatalError:m,isCellular:!1,nativeVideoDurationMs:k.duration*c.gJ||-1,numberOfStalls:g,numberOfSeeks:P,overallPausedDurationMs:b,overallBufferDurationMs:v,overallWatchedDurationMs:-1,rebufferRate:-1,playbackSessionId:this.videoSessionId,playbackStartTimestamp:S||-1,segments:[],sessionMark:e,screenPixelScale:null!==(_=window)&&void 0!==_&&_.devicePixelRatio?window.devicePixelRatio:-1,startupPlayerWidth:k.clientWidth,startupPlayerHeight:k.clientHeight,startupTimeMs:w,startupLatencyMs:T,startupVariantKbps:-1,startupVariantWatchedDurationMs:-1,startupVariantWidth:k.videoWidth,startupVariantHeight:k.videoHeight,videoUrl:D};if(!E){this.updateWatchDurationForCurrentSegment(),this.updateStallDuration();const e=f.reduce(((e,t)=>e+(t.watchedDurationMs||0)),0);L.overallWatchedDurationMs=e,L.startupVariantWatchedDurationMs=e,L.segments=this.playbackPerformance.segments,0===e?(L.errorName="invalid_watch_duration",L.rebufferRate=-1):L.rebufferRate=v/e}(0,h.ZP)(L,!1,o,{playbackState:this.state.playbackState,...t});const{view:C,viewParameter:A,component:M,element:I,objectId:x,...V}=a;n({event_type:3606,event_data:{videoPerformanceData:L},view_type:C,view_parameter:A,component:M,element:I,object_id_str:x,aux_data:{...V,is_closeup_video:o,playback_session_id:this.videoSessionId}}),E?(this.hasVideoSessionStarted=!0,this.hasVideoSessionEnded=!1):this.resetPlaybackMetrics(),(0,h.tE)(E?"sessionStart":"sessionEnd",!1,o,{playbackState:this.state.playbackState,...t})}}))}componentWillUnmount(){const{loop:e}=this.props;this.updatePauseDuration(),this.logPlaybackPerformance(c.$f,{initiator:"unmount",loop:e})}render(){const{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,captions:l,controls:h,loop:c,loopOverride:p,objectFit:y,onDurationChange:b,onFullscreenChange:v,onLoadedChange:g,onControlsPlay:P,onPlayheadDown:S,onPlayheadUp:f,onSeek:D,onVolumeChange:k,playbackRate:E,playing:w,playsInline:T,poster:_,preload:R,src:L,volume:C}=this.props,{canPlayVideo:A}=this.state;return(0,u.jsx)(d.nk,{autoplay:A&&w,accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,captions:l,controls:h,loop:void 0===p?c:p,objectFit:y,onDurationChange:b,onEnded:this.handleEnded,onError:this.handleError,onFullscreenChange:v,onLoadedChange:g,onLoadStart:this.handleLoadStart,onControlsPause:this.handleUserPause,onControlsPlay:P,onPlaying:this.handlePlaying,onPlayheadDown:S,onPlayheadUp:f,onReady:this.handleCanPlayVideo,onSeek:D,onSeeking:this.handleSeeking,onStalled:this.handleStalled,onTimeChange:this.handleTimeUpdate,onVolumeChange:k,onWaiting:this.handleStalled,playbackRate:E,onPlay:()=>{},onPlayError:()=>{},playing:A&&w,playsInline:T,poster:_,preload:R,ref:this.setVideoPlayerRef,src:m(L,this.props.quicExpGroup),volume:C})}}const b=(0,i.memo)((function(e){const{logContextEvent:t}=(0,o.v)(),{country:a,isAuthenticated:i,isBot:d,isSocialBot:c,unauthId:p,userAgent:m}=(0,l.B)(),{browserName:b,browserVersion:v,isMobile:g}=m,{contextLogData:P={}}=e,{is_closeup_video:S=!1,view:f,viewParameter:D}=P,{appUI:{appInFocus:k}}=(0,n.I)(),{checkExperiment:E}=(0,r.F)();let w=null;i&&(w=E("web_video_quic").group.length?E("web_video_quic").group:null);const T=(0,s.Z)(),_={browserName:b,browserVersion:v,country:a,isAuthenticated:i,isBot:d,is_closeup_video:S,isMobile:g,isSocialBot:c,view:f,viewParameter:D};return(0,h.r$)(_),(0,u.jsx)(y,{...e,userId:T.id||p,appInFocus:k,quicExpGroup:w,logContextEvent:t})}));var v=a(562559),g=a(366284);function P(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const S=e=>{if(Array.isArray(e)){const t=e.find((e=>"video/m3u8"===e.type));return t?t.src:void 0}return RegExp("m3u8$").test(e)?e:void 0};class f extends i.PureComponent{constructor(e){super(e),P(this,"componentDidUpdate",((e,t)=>{var a;e.videoStartTime&&this.props.videoStartTime&&e.videoStartTime<this.props.videoStartTime&&null!==(a=this.videoPlayerRef)&&void 0!==a&&a.video&&(this.videoPlayerRef.video.currentTime=this.props.videoStartTime)})),P(this,"setVideoPlayerRef",(e=>{e&&(this.videoPlayerRef=e)})),P(this,"handleOnEnded",(({event:e})=>{const{loop:t,onLoop:a,onEnded:i}=this.props;i&&(i({event:e}),this.videoPlayerRef&&this.videoPlayerRef.video&&t&&(this.videoPlayerRef.video.play(),a&&a()))}));const t=S(e.src);this.state={useHlsVideo:!e.preferMp4&&!(0,g.G6)(e.requestContext.userAgent.browserName)&&!!t}}render(){const{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,appInFocus:l,backgroundColor:d,captions:h,contextLogData:c,controls:p,hlsConfig:m,isAutoPlay:y,loop:g,objectFit:P,onDurationChange:f,onEnded:D,onFullscreenChange:k,onLoadedChange:E,onControlsPause:w,onControlsPlay:T,onPlayheadDown:_,onPlayheadUp:R,onReady:L,onSeek:C,onTimeChange:A,onVolumeChange:M,playbackRate:I,playing:x,playsInline:V,poster:F,preferMp4:N,preload:O,src:W,videoStartTime:H,visible:B,volume:U}=this.props,{useHlsVideo:z}=this.state,K=S(W),G={...m,startPosition:H||-1},$=!D&&g;return z&&K?(0,u.jsx)(v.Z,{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,appInFocus:l,backgroundColor:d,captions:h,contextLogData:c,controls:p,hlsConfig:G,isAutoPlay:y,loop:g,loopOverride:$,onDurationChange:f,onEnded:this.handleOnEnded,onFullscreenChange:k,onLoadedChange:E,onControlsPause:w,onControlsPlay:T,onPlayheadDown:_,onPlayheadUp:R,onReady:L,onSeek:C,onTimeChange:A,onVolumeChange:M,playbackRate:I,onPlay:()=>{},onPlayError:()=>{},playing:x,playsInline:V,poster:F,preload:O,setVideoRef:this.setVideoPlayerRef,src:K,visible:B,volume:U}):(0,u.jsx)(b,{accessibilityMaximizeLabel:e,accessibilityMinimizeLabel:t,accessibilityMuteLabel:a,accessibilityPauseLabel:i,accessibilityPlayLabel:s,accessibilityProgressBarLabel:n,accessibilityUnmuteLabel:o,aspectRatio:r,captions:h,contextLogData:c,controls:p,isAutoPlay:y,loop:g,loopOverride:$,objectFit:P,onDurationChange:f,onEnded:this.handleOnEnded,onFullscreenChange:k,onLoadedChange:E,onControlsPause:w,onControlsPlay:T,onPlayheadDown:_,onPlayheadUp:R,onReady:L,onSeek:C,onTimeChange:A,onVolumeChange:M,playbackRate:I,onPlay:()=>{},onPlayError:()=>{},playing:x,playsInline:V,poster:F,preload:O,setVideoRef:this.setVideoPlayerRef,src:N?W:K||W,videoStartTime:H,visible:B,volume:U})}}function D(e){const{appUI:{appInFocus:t}}=(0,n.I)(),a=(0,l.B)();return(0,u.jsx)(f,{...e,appInFocus:t,requestContext:a})}},559230:(e,t,a)=>{a.d(t,{HJ:()=>s,VS:()=>i,iM:()=>n});const i=2,s="V_HLSV3_MOBILE",n=[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.11,.12,.13,.14,.15,.16,.17,.18,.19,.2,.21,.22,.23,.24,.25,.26,.27,.28,.29,.3,.31,.32,.33,.34,.35,.36,.37,.38,.39,.4,.41,.42,.43,.44,.45,.46,.47,.48,.49,.5,.51,.52,.53,.54,.55,.56,.57,.58,.59,.6,.61,.62,.63,.64,.65,.66,.67,.68,.69,.7,.71,.72,.73,.74,.75,.76,.77,.78,.79,.8,.81,.82,.83,.84,.85,.86,.87,.88,.89,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1]},875495:(e,t,a)=>{function i(e){return{type:"FEED_ITEM_REORDERED",payload:e}}function s(e,t){return{type:"FEED_INVALIDATE",payload:{feedType:e,feedId:t}}}a.d(t,{EX:()=>o,N8:()=>s,Qv:()=>n,_f:()=>i,vX:()=>r});const n=(e,t,a=Object.freeze({}))=>({type:"APPEND_FEED_ITEMS",payload:{id:e,options:a,items:t}});function o(e){return{type:"FEED_ITEMS_REMOVED",payload:e}}function r(e){return{type:"FEED_ITEMS_ADDED",payload:e}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/26348.en_GB-07f8843f02a1ff09.mjs.map